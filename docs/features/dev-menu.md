# 開発メニュー

**カテゴリ**: 開発支援 | **優先度**: 任意

開発ビルド時のみ表示されるデバッグ・管理用メニューを実装する。

---

## 目的

- 開発時のデバッグ効率向上
- アプリ状態の可視化
- テストデータ・キャッシュの管理

---

## アクセス方法

- `pnpm tauri dev` 実行時のみメニューに表示
- 本番ビルドでは非表示
- 環境変数 `import.meta.env.DEV` で判定

---

## 機能一覧

### 1. デバッグログ表示

アプリ内のログをリアルタイム表示：

| 項目 | 説明 |
|-----|------|
| ログレベル | DEBUG / INFO / WARN / ERROR |
| フィルタ | レベル・モジュール別にフィルタ可能 |
| 表示形式 | タイムスタンプ付きリスト |
| 操作 | クリア、コピー |

### 2. 状態インスペクタ

現在のアプリ状態を確認：

| 項目 | 説明 |
|-----|------|
| Settings | 現在の設定値 |
| Whisper | 文字起こし状態 |
| Recording | 録音状態 |
| Models | モデル読み込み状態 |

### 3. キャッシュクリア

各種キャッシュ・データの削除：

| 対象 | 説明 |
|-----|------|
| 履歴 | 文字起こし履歴をすべて削除 |
| 設定 | 設定をデフォルトにリセット |
| 一時ファイル | 変換済み音声ファイルなど |

### 4. モデル管理

ダウンロード済みモデルの管理：

| 操作 | 説明 |
|-----|------|
| 一覧表示 | ダウンロード済みモデルとサイズ |
| 削除 | 選択したモデルを削除 |
| 全削除 | すべてのモデルを削除 |

---

## テスト要件

### TypeScript (Vitest)

`src/components/dev/__tests__/DevMenu.test.tsx`:

| テスト | 内容 |
|-------|------|
| 表示制御 | DEV環境でのみ表示される |
| 表示制御 | PROD環境では表示されない |
| ログ表示 | ログ一覧が表示される |
| 状態表示 | 現在の状態が表示される |
| キャッシュクリア | クリアボタンで削除が実行される |
| モデル削除 | 削除ボタンでモデルが削除される |

---

## 実装内容

### 1. 環境判定

```
import.meta.env.DEV  // true: 開発, false: 本番
```

### 2. コンポーネント構成

| コンポーネント | 説明 |
|--------------|------|
| `DevMenu` | メインコンテナ（条件付きレンダリング） |
| `DebugLog` | ログ表示パネル |
| `StateInspector` | 状態表示パネル |
| `CacheClear` | キャッシュクリアUI |
| `ModelManager` | モデル管理UI |

### 3. メニュー配置

- サイドメニューまたはヘッダーに「Dev」メニュー項目を追加
- 開発ビルド時のみ表示

---

## 依存機能

| 機能 | 必須 | 理由 |
|-----|------|------|
| 履歴管理 | No | キャッシュクリアで使用 |
| 設定永続化 | No | 設定リセットで使用 |
| モデル管理 | No | モデル削除で使用 |

---

## 作成ファイル

| ファイル | 説明 |
|---------|------|
| `src/components/dev/__tests__/DevMenu.test.tsx` | **テスト（先に作成）** |
| `src/components/dev/DevMenu.tsx` | メインコンポーネント |
| `src/components/dev/DebugLog.tsx` | ログ表示 |
| `src/components/dev/StateInspector.tsx` | 状態表示 |
| `src/components/dev/CacheClear.tsx` | キャッシュクリア |
| `src/components/dev/ModelManager.tsx` | モデル管理 |

---

## 完了条件

- [ ] `pnpm test` でテストが通る
- [ ] 開発ビルドでのみ開発メニューが表示される
- [ ] 本番ビルドでは開発メニューが表示されない
- [ ] デバッグログが表示される
- [ ] 状態インスペクタが動作する
- [ ] キャッシュクリアが動作する
- [ ] モデル削除が動作する
