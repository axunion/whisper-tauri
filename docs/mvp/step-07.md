# Step 7: メインアプリ統合

**Phase 1: MVP** | 必須

全コンポーネントを統合してメインアプリケーションを完成させる。

---

## 目的

- 全コンポーネントの統合
- 完全なワークフローの実現
- MVP完成

---

## テスト要件

### TypeScript (Vitest)

`src/__tests__/App.test.tsx`:

| テスト | 内容 |
|-------|------|
| render | アプリがエラーなくレンダリングされる |
| render | ヘッダーにアプリタイトルが表示される |
| loadModels | マウント時に loadModels が呼ばれる |
| canStartTranscription | ファイルとモデル未選択時は開始ボタンが無効 |

---

## 実装内容

### 1. App.tsx

メインアプリケーションコンポーネント。

#### 構成

```
<App>
├── <header> - アプリタイトル
├── <main>
│   ├── エラー表示（条件付き）
│   ├── <FileSelector>
│   ├── <ModelSelector>
│   ├── <ProgressBar>（処理中のみ）
│   ├── 開始ボタン（結果なし・非処理中のみ）
│   └── <ResultViewer>（結果あり時）
│       └── 新規ファイル / 再実行ボタン
└── <footer> - バージョン表示
```

#### 処理フロー

1. `onMount` で `whisper.loadModels()` を呼び出し
2. ファイル選択 → `whisper.setFile()`
3. モデル選択 → `whisper.selectModel()`
4. 開始ボタンクリック → `whisper.startTranscription()`
5. 結果表示 / エラー表示

#### 開始ボタンの有効条件

- ファイルが選択されている
- モデルが選択されている
- 処理中でない

### 2. App.css

アプリ固有のスタイル。

- カスタムスクロールバー（webkit）
- その他のアプリ固有スタイル

### 3. index.tsx / index.css の確認

- index.tsx: `solid-js/web` の `render` でAppをマウント
- index.css: Tailwindディレクティブとベーススタイル

---

## 作成/編集ファイル

| ファイル | 説明 |
|---------|------|
| `src/__tests__/App.test.tsx` | **テスト（先に作成）** |
| `src/App.tsx` | メインアプリ |
| `src/App.css` | アプリスタイル |
| `src/index.tsx` | エントリーポイント確認 |
| `src/index.css` | グローバルスタイル確認 |

---

## UIレイアウト

### ヘッダー
- 白背景、下線
- アプリタイトル「Whisper Local」

### メインコンテンツ
- 最大幅 `max-w-3xl`、中央揃え
- 各セクションは白背景のカードスタイル（`rounded-2xl shadow-sm`）
- セクション間は `space-y-6` でマージン

### フッター
- バージョン表示（中央揃え、小さめのグレーテキスト）

---

## 完了条件（MVP完了）

- [ ] `pnpm test` で全テストが通る
- [ ] `cargo test` で全テストが通る
- [ ] `pnpm tauri dev` でアプリが正常に起動する
- [ ] ファイル選択ができる
- [ ] モデルをダウンロードできる
- [ ] モデルを選択できる
- [ ] 文字起こしを開始できる
- [ ] 進捗が表示される
- [ ] 結果が表示される
- [ ] 結果をコピーできる

---

## MVP完了後の動作確認手順

1. アプリを起動 (`pnpm tauri dev`)
2. モデル一覧が表示されることを確認
3. 「base」モデルをダウンロード
4. ダウンロード進捗が表示されることを確認
5. ダウンロード完了後、モデルを選択
6. WAVファイルを選択
7. 「文字起こしを開始」ボタンをクリック
8. 進捗が表示されることを確認
9. 結果が表示されることを確認
10. 「コピー」ボタンで結果がコピーできることを確認

---

## MVP完了！

基本的な文字起こし機能が動作する状態になりました。

追加機能については [features/](../features/) を参照してください。
